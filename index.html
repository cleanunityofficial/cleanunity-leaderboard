async function fetchData() {
  const res = await fetch(CSV_URL);
  const data = await res.text();
  const rows = data.trim().split('\n');
  const tbody = document.getElementById("leaderboard-body");
  tbody.innerHTML = "";

  // Skip the header row, then map each row
  rows.slice(1).forEach((row, idx) => {
    const cols = row.split(",");
    const name = cols[0].trim();
    const points = cols[1].trim();
    const rank = cols[2].trim();

    const tr = document.createElement("tr");

    const rankTd = document.createElement("td");
    rankTd.dataset.label = "Rank";
    if (idx === 0) {
      rankTd.innerHTML = '<span class="medal">ðŸ¥‡</span>';
    } else if (idx === 1) {
      rankTd.innerHTML = '<span class="medal">ðŸ¥ˆ</span>';
    } else if (idx === 2) {
      rankTd.innerHTML = '<span class="medal">ðŸ¥‰</span>';
    } else {
      rankTd.textContent = rank || (idx + 1);
    }

    const nameTd = document.createElement("td");
    nameTd.dataset.label = "Full Name";
    nameTd.textContent = name;

    const pointsTd = document.createElement("td");
    pointsTd.dataset.label = "Points";
    pointsTd.textContent = points;

    tr.appendChild(rankTd);
    tr.appendChild(nameTd);
    tr.appendChild(pointsTd);
    tbody.appendChild(tr);
  });
}
